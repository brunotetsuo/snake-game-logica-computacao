<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Cobrinha do Luiz L√≥gica de Computa√ß√£o</title>
    <style>
      :root {
        --bg: #0f1724;
        --grid: #0b1220;
        --snake: #7ee787;
        --food: #4dabf7;
        --panel: #0b1220cc;
        --text: #e6eef8;
      }
      body {
        margin: 0;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        background: linear-gradient(180deg, var(--bg), #071025);
        color: var(--text);
        font-family: Inter, system-ui, sans-serif;
        gap: 12px;
        overflow: hidden;
      }
      h2 {
        font-size: 22px;
        text-align: center;
        max-width: 500px;
      }
      canvas {
        background: linear-gradient(180deg, var(--grid), #031026);
        border-radius: 12px;
        box-shadow: 0 8px 30px rgba(2, 6, 23, 0.6),
          inset 0 1px 0 rgba(255, 255, 255, 0.02);
        image-rendering: pixelated;
      }
      .score {
        font-size: 20px;
      }
      .controls {
        display: flex;
        gap: 10px;
      }
      button {
        padding: 8px 14px;
        border-radius: 8px;
        border: none;
        background: #0b2036;
        color: var(--text);
        font-weight: 600;
        cursor: pointer;
      }
      /* Tela inicial */
      .start-screen {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(15, 23, 36, 0.95);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 10;
        animation: fadeIn 1s ease;
      }
      .start-screen h1 {
        font-size: 34px;
        text-align: center;
        color: #7ee787;
        animation: pulse 2s infinite;
      }
      @keyframes pulse {
        0% {
          text-shadow: 0 0 8px #7ee787;
        }
        50% {
          text-shadow: 0 0 18px #7ee787;
        }
        100% {
          text-shadow: 0 0 8px #7ee787;
        }
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }
    </style>
  </head>
  <body>
    <div class="start-screen" id="startScreen">
      <h1>Cobrinha do Luizüêç<br />L√≥gica de Computa√ß√£o</h1>
      <button id="startBtn">Iniciar Jogo</button>
    </div>

    <h2 id="question">Clique em Iniciar para come√ßar</h2>
    <canvas id="game" width="600" height="600"></canvas>
    <div class="score" id="score">Score: 0</div>
    <div class="controls">
      <button id="pauseBtn">Pausar</button>
    </div>

    <script>
      let bgMusic = new Audio("music.mp3");
      bgMusic.loop = true;
      bgMusic.volume = 0.3;

      const canvas = document.getElementById("game");
      const ctx = canvas.getContext("2d");
      const questionEl = document.getElementById("question");
      const scoreEl = document.getElementById("score");
      const pauseBtn = document.getElementById("pauseBtn");
      const startScreen = document.getElementById("startScreen");
      const startBtn = document.getElementById("startBtn");

      const TILE_COUNT = 20;
      let tileSize = canvas.width / TILE_COUNT;

      const correctSound = new Audio("correct.wav");
      const wrongSound = new Audio("failure.wav");

      const questions = [
        { q: "Se, somente se", options: ["‚Üî", "‚Üí"], correct: 0 },
        {
          q: "E",
          options: ["‚à®", "‚àß"],
          correct: 1,
        },
        { q: "True ‚àß True", options: ["True", "False"], correct: 0 },
        { q: "True ‚Üí False", options: ["False", "True"], correct: 0 },
        {
          q: "N√£o True",
          options: ["True", "False"],
          correct: 1,
        },
      ];

      let snake, dir, nextDir, foods, score, gameOver, currentQuestion, paused;
      let effectColor = null;
      let effectTimer = 0;
      let running = false;

      function spawnFoods() {
        const pos = [];
        while (pos.length < 2) {
          const p = {
            x: Math.floor(Math.random() * TILE_COUNT),
            y: Math.floor(Math.random() * TILE_COUNT),
          };
          if (
            !snake.some((s) => s.x === p.x && s.y === p.y) &&
            !pos.some((f) => f.x === p.x && f.y === p.y)
          ) {
            pos.push(p);
          }
        }
        return pos;
      }

      function resetGame() {
        snake = Array.from({ length: 5 }, (_, i) => ({ x: 10 - i, y: 10 }));
        dir = { x: 0, y: 0 };
        nextDir = { x: 0, y: 0 };
        currentQuestion = 0;
        questionEl.textContent = "Clique em Iniciar para come√ßar";
        foods = spawnFoods();
        score = 0;
        gameOver = false;
        paused = false;
        running = false;
        scoreEl.textContent = "Score: " + score;
        draw();
      }

      function setNextDir(x, y) {
        if (dir.x === -x && dir.y === -y) return;
        nextDir = { x, y };
      }

      window.addEventListener("keydown", (e) => {
        const key = e.key.toLowerCase();
        if (key === "arrowup" || key === "w") setNextDir(0, -1);
        if (key === "arrowdown" || key === "s") setNextDir(0, 1);
        if (key === "arrowleft" || key === "a") setNextDir(-1, 0);
        if (key === "arrowright" || key === "d") setNextDir(1, 0);
        if (key === " " && running) paused = !paused;
      });

      startBtn.addEventListener("click", () => {
        bgMusic.play();

        startScreen.style.display = "none";
        resetGame();
        dir = { x: 1, y: 0 };
        nextDir = { x: 1, y: 0 };
        running = true;
        questionEl.textContent = questions[currentQuestion].q;
        requestAnimationFrame(loop);
      });

      pauseBtn.addEventListener("click", () => {
        if (!running) return;
        paused = !paused;

        if (paused) {
          pauseBtn.textContent = "Continuar";
          bgMusic.pause(); // pausa a m√∫sica
        } else {
          pauseBtn.textContent = "Pausar";
          bgMusic.play(); // retoma a m√∫sica
        }
      });

      function update() {
        if (gameOver || paused || !running) return;

        if (nextDir.x !== 0 || nextDir.y !== 0) dir = { ...nextDir };
        const head = { x: snake[0].x + dir.x, y: snake[0].y + dir.y };

        if (head.x < 0) head.x = TILE_COUNT - 1;
        if (head.x >= TILE_COUNT) head.x = 0;
        if (head.y < 0) head.y = TILE_COUNT - 1;
        if (head.y >= TILE_COUNT) head.y = 0;

        if (snake.some((s, i) => i > 0 && s.x === head.x && s.y === head.y)) {
          gameOver = true;
          return;
        }

        snake.unshift(head);

        const ateIndex = foods.findIndex(
          (f) => f.x === head.x && f.y === head.y
        );

        if (ateIndex !== -1) {
          const isCorrect = ateIndex === questions[currentQuestion].correct;

          if (isCorrect) {
            score++;
            correctSound.play();
            // alterado de azul para verde
            effectColor = "rgba(0,255,100,0.4)";
            snake.push({ ...snake[snake.length - 1] });
          } else {
            wrongSound.play();
            effectColor = "rgba(255,0,0,0.4)";

            if (snake.length <= 2) {
              gameOver = true;
            } else {
              snake.pop();
              snake.pop();
            }
          }

          scoreEl.textContent = "Score: " + score;
          currentQuestion = (currentQuestion + 1) % questions.length;
          questionEl.textContent = questions[currentQuestion].q;
          foods = spawnFoods();
          effectTimer = 15;
        } else {
          snake.pop();
        }
      }

      function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        tileSize = canvas.width / TILE_COUNT;

        if (effectTimer > 0 && effectColor) {
          ctx.fillStyle = effectColor;
          ctx.fillRect(0, 0, canvas.width, canvas.height);
          effectTimer--;
        }

        foods.forEach((f, i) => {
          const padding = 2;
          ctx.fillStyle = getComputedStyle(document.documentElement)
            .getPropertyValue("--food")
            .trim();
          ctx.fillRect(
            f.x * tileSize + padding,
            f.y * tileSize + padding,
            tileSize - 2 * padding,
            tileSize - 2 * padding
          );

          ctx.fillStyle = "#ffffff";
          ctx.font = `bold ${Math.floor(tileSize * 0.55)}px Inter`;
          ctx.textAlign = "center";
          ctx.textBaseline = "middle";
          ctx.fillText(
            questions[currentQuestion].options[i],
            f.x * tileSize + tileSize / 2,
            f.y * tileSize + tileSize / 2
          );
        });

        snake.forEach((s, i) => {
          const t = 1 - i / Math.max(8, snake.length);
          ctx.fillStyle = `rgba(126,231,135,${0.35 + 0.65 * t})`;
          ctx.fillRect(
            s.x * tileSize + 1,
            s.y * tileSize + 1,
            tileSize - 2,
            tileSize - 2
          );
        });

        if (gameOver) {
          ctx.fillStyle = "rgba(0,0,0,0.7)";
          ctx.fillRect(0, 0, canvas.width, canvas.height);
          ctx.fillStyle = "#ff6b6b";
          ctx.font = "bold 42px Inter";
          ctx.textAlign = "center";
          ctx.fillText("GAME OVER", canvas.width / 2, canvas.height / 2);
          setTimeout(() => {
            startScreen.style.display = "flex";
          }, 1500);
        }

        if (paused && running && !gameOver) {
          ctx.fillStyle = "rgba(0,0,0,0.45)";
          ctx.fillRect(0, 0, canvas.width, canvas.height);
          ctx.fillStyle = "#e6eef8";
          ctx.font = "bold 36px Inter";
          ctx.textAlign = "center";
          ctx.fillText("PAUSADO", canvas.width / 2, canvas.height / 2);
        }
      }

      let frameCount = 0;
      const speed = 10;

      function loop() {
        if (!running) return;

        frameCount++;
        if (frameCount % speed === 0) {
          update();
        }
        draw();
        requestAnimationFrame(loop);
      }

      resetGame();
    </script>
  </body>
</html>
